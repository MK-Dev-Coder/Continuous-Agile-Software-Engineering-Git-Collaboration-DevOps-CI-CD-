<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Smart Home AI Assistant</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1e1e1e;
            color: white;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 8px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #555;
            border-radius: 4px;
            background-color: #333;
            color: white;
        }
        #status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success { background-color: #4CAF50; }
        .error { background-color: #f44336; }
        .warning { background-color: #ff9800; }
    </style>
</head>
<body>
    <h1>Smart Home AI Assistant - Test Page</h1>
    
    <div class="test-section">
        <h3>API Key Test</h3>
        <input type="password" id="apiKeyInput" placeholder="Enter test API key">
        <button id="saveApiKey">Save API Key</button>
        <div id="apiStatus"></div>
    </div>
    
    <div class="test-section">
        <h3>WebSocket Test</h3>
        <button id="connectArduino">Connect to Server</button>
        <div id="arduinoStatus"></div>
    </div>
    
    <div class="test-section">
        <h3>Sensor Data Test</h3>
        <div>Temperature: <span id="tempValue">--</span></div>
        <div>Humidity: <span id="humidityValue">--</span></div>
        <div>Light: <span id="lightValue">--</span></div>
        <div>Motion: <span id="motionValue">--</span></div>
    </div>
    
    <div class="test-section">
        <h3>Voice Test</h3>
        <button id="micButton">üé§ Start Listening</button>
        <div id="status"></div>
    </div>

    <script>
        // Simple test script
        console.log('Test page loaded');
        
        // Test API Key functionality
        document.getElementById('saveApiKey').addEventListener('click', function() {
            const apiKey = document.getElementById('apiKeyInput').value;
            if (apiKey) {
                localStorage.setItem('gemini_api_key', apiKey);
                document.getElementById('apiStatus').innerHTML = '‚úÖ API Key saved!';
                document.getElementById('apiStatus').className = 'success';
                console.log('API Key saved:', apiKey);
            } else {
                document.getElementById('apiStatus').innerHTML = '‚ùå Please enter an API key';
                document.getElementById('apiStatus').className = 'error';
            }
        });
        
        // Test WebSocket connection
        document.getElementById('connectArduino').addEventListener('click', function() {
            try {
                const ws = new WebSocket('ws://localhost:3000');
                
                ws.onopen = function() {
                    document.getElementById('arduinoStatus').innerHTML = '‚úÖ Connected to WebSocket server';
                    document.getElementById('arduinoStatus').className = 'success';
                    console.log('WebSocket connected');
                };
                
                ws.onerror = function(error) {
                    document.getElementById('arduinoStatus').innerHTML = '‚ùå Connection failed';
                    document.getElementById('arduinoStatus').className = 'error';
                    console.error('WebSocket error:', error);
                };
                
                ws.onclose = function() {
                    document.getElementById('arduinoStatus').innerHTML = '‚ö†Ô∏è Connection closed';
                    document.getElementById('arduinoStatus').className = 'warning';
                    console.log('WebSocket closed');
                };
                
            } catch (error) {
                document.getElementById('arduinoStatus').innerHTML = '‚ùå Error: ' + error.message;
                document.getElementById('arduinoStatus').className = 'error';
                console.error('WebSocket error:', error);
            }
        });
        
        // Test sensor simulation
        function updateSensors() {
            document.getElementById('tempValue').textContent = (20 + Math.random() * 10).toFixed(1) + '¬∞C';
            document.getElementById('humidityValue').textContent = (40 + Math.random() * 30).toFixed(0) + '%';
            document.getElementById('lightValue').textContent = Math.floor(100 + Math.random() * 900) + ' lux';
            document.getElementById('motionValue').textContent = Math.random() > 0.7 ? 'Detected' : 'Clear';
        }
        
        // Update sensors every 2 seconds
        setInterval(updateSensors, 2000);
        
        // Test voice recognition
        document.getElementById('micButton').addEventListener('click', function() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                document.getElementById('status').innerHTML = '‚úÖ Speech recognition is supported!';
                document.getElementById('status').className = 'success';
            } else {
                document.getElementById('status').innerHTML = '‚ùå Speech recognition not supported in this browser';
                document.getElementById('status').className = 'error';
            }
        });
        
        // Load saved API key
        window.addEventListener('load', function() {
            const savedKey = localStorage.getItem('gemini_api_key');
            if (savedKey) {
                document.getElementById('apiKeyInput').value = savedKey;
                document.getElementById('apiStatus').innerHTML = '‚úÖ API Key loaded from storage';
                document.getElementById('apiStatus').className = 'success';
            }
        });
    </script>
</body>
</html>
